# [\#14707 Issue](https://github.com/ethereum/solidity/issues/14707) `closed`: An issue arises when using the `--import-ast` option to process an AST containing inline assembly.
**Labels**: `bug :bug:`, `low effort`, `low impact`, `must have`


#### <img src="https://avatars.githubusercontent.com/u/76193362?u=4e8ae4cdf21413eec9e64a60a16dda14baf9a47f&v=4" width="50">[lum7na](https://github.com/lum7na) opened issue at [2023-11-29 12:29](https://github.com/ethereum/solidity/issues/14707):

<!--## Prerequisites

- First, many thanks for taking part in the community. We really appreciate that.
- We realize there is a lot of information requested here. We ask only that you do your best to provide as much information as possible so we can better help you.
- Support questions are better asked in one of the following locations:
    - [Solidity chat](https://gitter.im/ethereum/solidity)
    - [Stack Overflow](https://ethereum.stackexchange.com/)
- Ensure the issue isn't already reported.
- The issue should be reproducible with the latest solidity version; however, this isn't a hard requirement and being reproducible with an older version is sufficient.

*Delete the above section and the instructions in the sections below before submitting*
-->

## Description

<!--Please shortly describe the bug you have found, and what you expect instead.-->

The `--import-ast` option of `solc` is failing to correctly recognize the AST generated by an empty `let` statement.

This bug prevents `solc` from passing the `test/libsolidity/semanticTests/inlineAssembly/inlineasm_empty_let.sol` test case.

## Environment

- Compiler version: commit `7df949edb22598e9d946660020c5390d0ce81bf8`
- Target EVM version (as per compiler settings): `shanghai`

## Steps to Reproduce

<!--
Please provide a *minimal* source code example to trigger the bug you have found.
Please also mention any command-line flags that are necessary for triggering the bug.
Provide as much information as necessary to reproduce the bug.

```solidity
// Some *minimal* Solidity source code to reproduce the bug.
// ...
```
-->

1. Generate the AST in JSON format: `solc --combined-json ast inlineasm_empty_let.sol > ast.json`
2. Compile using the `--import-ast` option: `solc --import-ast ast.json`

`solc` should report an error: `Error: Failed to import AST: Expected "nodeType" to be of type string.`

This appears to be due to the `createVariableDeclaration` function in the `libyul/AsmJsonImporter.cpp` file not handling an empty `value` appropriately.

#### <img src="https://avatars.githubusercontent.com/u/95899911?u=b80e228dd73aa60cc8cc18ebf2e9e72a0840b7d5&v=4" width="50">[matheusaaguiar](https://github.com/matheusaaguiar) commented at [2023-12-01 20:23](https://github.com/ethereum/solidity/issues/14707#issuecomment-1836729445):

Hi @lum7na, thanks for your report.
This problem can be triggered by the following minimal code snippet:
```solidity
contract C {
  function f() public pure {
    assembly {
      let x
    }
  }
}
```
You are right, this is a problem with `AsmJsonImporter::createVariableDeclaration`.  The generated `ast` does not have a `value` object associated with the variable and that is not checked against, resulting in a `Json::nullValue` being passed to `AsmJsonImporter::createExpression` where the error originates from.
I think that simply safeguarding against a non-existent `value` object in `AsmJsonImporter::createVariableDeclaration` should be enough to fix this problem.


-------------------------------------------------------------------------------



[Export of Github issue for [ethereum/solidity](https://github.com/ethereum/solidity). Generated on 2024.12.15 at 06:45:24.]
