# [\#6288 Issue](https://github.com/ethereum/solidity/issues/6288) `closed`: Strict assembly differential fuzzer works poorly with non ASCII characters as input
**Labels**: `testing :hammer:`


#### <img src="https://avatars.githubusercontent.com/u/2388185?v=4" width="50">[bshastry](https://github.com/bshastry) opened issue at [2019-03-14 13:54](https://github.com/ethereum/solidity/issues/6288):

## Description

The strict assembly differential fuzzer is a corpus based fuzzer whose goal is to find bugs in the yul optimizer. It does so by
  - feeding random input to the strict assembly assembly stack API
  - which then parses it
  - if parsed successfully, this input is traced using the yul interpreter (trace A)
  - next, the program is optimized
  - optimized program is again traced using the yul interpreter (trace B)
  - finally, traces A and B are checked for equality

Although we seed the fuzzer with a corpus of valid yul programs, eventually the fuzzer starts mutating this corpus with random characters.

The problem is that most random characters inserted into the input stream introduce parsing errors. This is bad because we ultimately want parseable programs for testing the optimizer unlike the `solc` fuzzers that are testing the solidity parser.

## Data

I conducted an experiment in which the differential fuzzer was run using a purely random test generator and one that selects only pure ascii input and here's what I found

Number of fuzzing runs = 300 k

| Strategy  | Parse success percentage |
| ------------- | ------------- |
| Random  | 7  |
| ASCII  | 41  |

As we can see, only 1 in 14 tests are actually parseable and create a trace. In the ASCII strategy, this improves to 2 in 5. Although, the ASCII strategy is still poor, it is much better (5 times better in this experiment) than what is currently adopted.

This makes a good case for selectively discarding non-ASCII input generated by the fuzzer. This will target the optimizer with a greater likelihood than the random generator alone.




-------------------------------------------------------------------------------



[Export of Github issue for [ethereum/solidity](https://github.com/ethereum/solidity). Generated on 2022.05.23 at 03:51:38.]
